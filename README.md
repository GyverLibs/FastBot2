# FastBot2 [beta]
Очень быстрая и лёгкая библиотека Telegram бота для Arduino, ESP8266, ESP32

## Режим опроса обновлений
### Sync (по умолчанию)
```cpp
bot.setPollMode(FastBot2::Poll::Sync, 4000);
```
#### Обновление
Такой же режим, как в первой версии: библиотека запрашивает обновления и ждёт ответа внутри `tick()`. При плохой связи может "зависать" внутри `tick()` на ощутимое (не дольше таймаута) время. Ставить период меньше 4000 не рекомендуется - сервер Телеграм "накажет" долгим ответом за слишком частый опрос!

#### Отправка сообщений
Отправка сообщений будет быстрой в любом месте программы, т.к. библиотека не ждёт ответа от сервера.

### Async
```cpp
bot.setPollMode(FastBot2::Poll::Async, 4000);
```
#### Обновление
"Асинхронный" режим - библиотека запросит обновления и обработает ответ, когда он придёт. Период опроса - такая же особенность, как в `Sync`.

#### Отправка сообщений
Если отправить сообщение НЕ в обработчике и ВО ВРЕМЯ ожидания ответа с обновлением - библиотека переподключится к серверу, что занимает около 1 секунды и блокирует выполнение программы. Для безопасной отправки из любого места в программе нужно отправлять сообщения, когда библиотека не ждёт ответа - проверить можно по флагу `waiting()`.

### Long
```cpp
bot.setPollMode(FastBot2::Poll::Long, 10000);
```
#### Обновление
Самый правильный способ опроса - асинхронный long polling. Период можно ставить побольше - от 10 секунд. Библиотека отправляет запрос и получит ответ либо по указанному таймауту, либо по факту поступления новых сообщений в бота. Таймаут переподключения - по умолчанию 300мс. Таким образом это самый быстрый и безопасный способ получения обновлений. Но есть но.

#### Отправка сообщений
Отправка сообщений в обработчике обновлений - безопасна, сообщения будут отправлены быстро. Если нужно отправить из другого места программы - по флагу `waiting()` можно узнать, ждёт ли библиотека ответ сервера. Если отправить пока ждёт - будет переподключение (зависнет на ~1 секунду).